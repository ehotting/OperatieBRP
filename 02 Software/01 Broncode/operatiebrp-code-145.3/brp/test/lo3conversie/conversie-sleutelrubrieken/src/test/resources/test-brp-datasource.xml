<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd">

    <!-- beans profile="!memoryDS">
        <context:property-placeholder location="classpath:datasource.properties,classpath:alp.properties" />
    </beans>
    <beans profile="memoryDS">
        <context:property-placeholder location="classpath:inmemory.properties,classpath:alp.properties" />
    </beans>

    <beans>
        <bean id="jpaVendorAdapter" class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="showSql" value="false" />
            <property name="generateDdl" value="false" />
            <property name="database" value="POSTGRESQL" />
            <property name="databasePlatform" value="org.hibernate.dialect.PostgreSQL82Dialect"/>
        </bean>

        <bean id="jpaDialect" class="org.springframework.orm.jpa.vendor.HibernateJpaDialect" />

        <bean id="templateDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close"
              abstract="true">
            <property name="driverClassName" value="${jdbc.driverClassName}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
            <property name="initialSize" value="1"/>
            <property name="maxActive" value="200"/>
            <property name="minIdle" value="1"/>
            <property name="maxIdle" value="5"/>
            <property name="testOnBorrow" value="true"/>
            <property name="testWhileIdle" value="true"/>
            <property name="testOnReturn" value="false"/>
            <property name="validationQuery" value="SELECT 41+1"/>
            <property name="defaultAutoCommit" value="true"/>
            <property name="defaultTransactionIsolation" value="2"/>
        </bean>
 -->
        <!--
           Data sources voor de default connectie van de applicatie (slaves die read-only zijn) en voor speciale functies zoals archivering/logging en protocollering (master) database connectie.
       -->
    <!--
        <bean id="alleenLezenDataSource" parent="templateDataSource">
            <property name="url" value="${jdbc.url}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
            <property name="defaultAutoCommit" value="true"/>
            <property name="defaultReadOnly" value="${jdbc.readonly:false}"/>
            <property name="defaultTransactionIsolation" value="${jdbc.transactionisolation:2}"/>
        </bean>

        <bean id="archiveringDataSource" parent="templateDataSource">
            <property name="url" value="${jdbc.url}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
        </bean>

        <bean id="alpDataSource" parent="templateDataSource">
            <property name="url" value="${jdbc.alp.url}"/>
            <property name="username" value="${jdbc.alp.username}"/>
            <property name="password" value="${jdbc.alp.password}"/>
        </bean>

        <bean id="lezenSchrijvenDataSource" parent="templateDataSource">
            <property name="url" value="${jdbc.url}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
        </bean>

        <bean id="masterSchrijvenDataSource" parent="templateDataSource">
            <property name="url" value="${jdbc.url}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
        </bean>



        <bean id="alleenLezenEntityManagerFactory" name="nl.bzk.brp.alleenlezen" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="persistenceUnitName" value="nl.bzk.brp.alleenlezen"/>
            <property name="packagesToScan" value="nl.bzk.brp.model" />
            <property name="dataSource" ref="alleenLezenDataSource" />
            <property name="jpaVendorAdapter" ref="jpaVendorAdapter" />
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.cache.use_second_level_cache">false</prop>
                    <prop key="hibernate.cache.use_query_cache">false</prop>
                    <prop key="hibernate.temp.use_jdbc_metadata_defaults">false</prop>
                    <prop key="hibernate.ejb.entitymanager_factory_name">nl.bzk.brp.lezenschrijven</prop>
                </props>
            </property>
        </bean>

        <bean id="alleenLezenAutAutEntityManagerFactory" name="nl.bzk.brp.alleenlezen.autaut" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="persistenceUnitName" value="nl.bzk.brp.alleenlezen.autaut"/>
            <property name="packagesToScan" value="nl.bzk.brp.levermodel"/>
            <property name="dataSource" ref="alleenLezenDataSource"/>
            <property name="jpaVendorAdapter" ref="jpaVendorAdapter"/>
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.cache.use_second_level_cache">${hibernate.use.second.level.cache:false}</prop>
                    <prop key="hibernate.cache.use_query_cache">${hibernate.use.query.cache:false}</prop>
                    <prop key="hibernate.generate_statistics">${hibernate.generate.statistics:false}</prop>
                    <prop key="hibernate.ejb.entitymanager_factory_name">nl.bzk.brp.alleenlezen.autaut</prop>
                    <prop key="hibernate.temp.use_jdbc_metadata_defaults">false</prop>
                </props>
            </property>
        </bean>

        <bean id="alleenLezenTransactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
            <property name="entityManagerFactory" ref="alleenLezenEntityManagerFactory" />
            <property name="jpaDialect" ref="jpaDialect" />
        </bean>

        <bean id="lezenSchrijvenEntityManagerFactory" name="nl.bzk.brp.lezenschrijven" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="persistenceUnitName" value="nl.bzk.brp.lezenschrijven"/>
            <property name="packagesToScan" value="nl.bzk.brp.model,nl.bzk.brp.dataaccess.repository.archivering.entity" />
            <property name="dataSource" ref="lezenSchrijvenDataSource" />
            <property name="jpaVendorAdapter" ref="jpaVendorAdapter" />
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.cache.use_second_level_cache">false</prop>
                    <prop key="hibernate.cache.use_query_cache">false</prop>
                    <prop key="hibernate.temp.use_jdbc_metadata_defaults">false</prop>
                    <prop key="hibernate.ejb.entitymanager_factory_name">nl.bzk.brp.alleenlezen</prop>
                </props>
            </property>
        </bean>

        <bean id="entityManagerFactoryMaster" name="nl.bzk.brp.master" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="persistenceUnitName" value="nl.bzk.brp.master"/>
            <property name="packagesToScan" value="nl.bzk.algemeenbrp.dal.domein.brp.entity,nl.bzk.brp.domain.leveringmodel.aut"/>
            <property name="dataSource" ref="masterSchrijvenDataSource" />
            <property name="jpaVendorAdapter" ref="jpaVendorAdapter" />
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.cache.use_second_level_cache">false</prop>
                    <prop key="hibernate.cache.use_query_cache">false</prop>
                    <prop key="hibernate.temp.use_jdbc_metadata_defaults">false</prop>
                    <prop key="hibernate.ejb.entitymanager_factory_name">nl.bzk.brp.master</prop>
                </props>
            </property>
        </bean>

        <bean id="entityManagerFactoryProt" name="nl.bzk.brp.protocollering" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="persistenceUnitName" value="nl.bzk.brp.protocollering"/>
            <property name="packagesToScan" value="nl.bzk.brp.protocollering.verwerking.entity"/>
            <property name="dataSource" ref="masterSchrijvenDataSource" />
            <property name="jpaVendorAdapter" ref="jpaVendorAdapter" />
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.cache.use_second_level_cache">false</prop>
                    <prop key="hibernate.cache.use_query_cache">false</prop>
                    <prop key="hibernate.temp.use_jdbc_metadata_defaults">false</prop>
                    <prop key="hibernate.ejb.entitymanager_factory_name">nl.bzk.brp.master</prop>
                </props>
            </property>
        </bean>

        <bean id="lezenSchrijvenTransactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
            <property name="entityManagerFactory" ref="lezenSchrijvenEntityManagerFactory" />
            <property name="jpaDialect" ref="jpaDialect" />
        </bean>
        <bean id="masterTransactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
            <property name="entityManagerFactory" ref="entityManagerFactoryMaster" />
            <property name="jpaDialect" ref="jpaDialect" />
        </bean>

        <bean id="archiveringEntityManagerFactory" name="nl.bzk.brp.archivering" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="persistenceUnitName" value="nl.bzk.brp.archivering"/>
            <property name="packagesToScan" value="nl.bzk.brp.model.operationeel.ber" />
            <property name="dataSource" ref="archiveringDataSource" />
            <property name="jpaVendorAdapter" ref="jpaVendorAdapter" />
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.cache.use_second_level_cache">false</prop>
                    <prop key="hibernate.cache.use_query_cache">false</prop>
                    <prop key="hibernate.temp.use_jdbc_metadata_defaults">false</prop>
                    <prop key="hibernate.ejb.entitymanager_factory_name">nl.bzk.brp.archivering</prop>
                </props>
            </property>
        </bean>

        <bean id="archiveringTransactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
            <property name="entityManagerFactory" ref="archiveringEntityManagerFactory" />
            <property name="jpaDialect" ref="jpaDialect" />
        </bean>
    </beans -->
</beans>
