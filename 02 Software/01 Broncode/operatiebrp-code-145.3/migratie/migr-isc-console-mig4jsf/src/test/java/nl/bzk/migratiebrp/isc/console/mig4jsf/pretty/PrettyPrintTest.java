/**
 * This file is copyright 2017 State of the Netherlands (Ministry of Interior Affairs and Kingdom Relations).
 * It is made available under the terms of the GNU Affero General Public License, version 3 as published by the Free Software Foundation.
 * The project of which this file is part, may be found at https://github.com/MinBZK/operatieBRP.
 */

package nl.bzk.migratiebrp.isc.console.mig4jsf.pretty;

import java.nio.charset.Charset;
import nl.bzk.migratiebrp.isc.console.mig4jsf.dto.Bericht;
import org.apache.commons.io.IOUtils;
import org.junit.Assert;
import org.junit.Test;

public class PrettyPrintTest {

    private static final String SYNC_INPUT_CONVERTEER_NAAR_BRP_VERZOEK =
            "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"
                    + "<ns1:converteerNaarBrpVerzoek xmlns:ns1=\"http://www.bzk.nl/migratiebrp/SYNC/0001\">"
                    + "<ns1:lo3BerichtAsTeletexString>01328011810110010580467945701200094008372250210010Josie "
                    +
                    "Beth0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008196608218230003PKA851000819660821861000819660822021500210006Bertha0240005Baarn03100081942083103200040013033000460300410001V621000819660821821000405188220008199409308230002PK851000819660821861000819940930031640210005Jozef0230007van der0240006Blaren03100081936010103200040599033000460300410001M621000819540304821000405188220008199409308230002PK85100081966082186100081994093004086051000400016310003001821000405188220008199409308230002PK851000819660821861000819940930070776810008199409306910004051870100010801000400038020017201207011435010008710001P08235091000406260920008199806221010001W1030008199806221110010S vd Oyeln1115038Baron Schimmelpenninck van der Oyelaan11200021611600062252EB1170011Voorschoten11800160626010010016001119001606262000100160017210001T85100082011031686100082011031758126091000406260920008199806221010001W1030008199806221110010S vd Oyeln11200021611600062252EB7210001I85100081998062286100081998062458131091000405180920008199010021010001W1030008199512131110014Waldorpsstraat112000330411600062521CG7210001I85100081997121386100081997121458133091000405180920008199010021010001W1030008199010021110017Van Swietenstraat11200022011600062518EH7210001A851000819901002861000819940930</ns1:lo3BerichtAsTeletexString>"
                    + "</ns1:converteerNaarBrpVerzoek>";

    private static final String SYNC_INPUT_CONVERTEER_NAAR_LO3_ANTWOORD =
            "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"
                    + "<ns1:converteerNaarLo3Antwoord xmlns:ns1=\"http://www.bzk.nl/migratiebrp/SYNC/0001\">"
                    + "<ns1:status>Ok</ns1:status>"
                    + "<ns1:lo3Pl>01328011810110010580467945701200094008372250210010Josie "
                    +
                    "Beth0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008196608218230003PKA851000819660821861000819660822021500210006Bertha0240005Baarn03100081942083103200040013033000460300410001V621000819660821821000405188220008199409308230002PK851000819660821861000819940930031640210005Jozef0230007van der0240006Blaren03100081936010103200040599033000460300410001M621000819540304821000405188220008199409308230002PK85100081966082186100081994093004086051000400016310003001821000405188220008199409308230002PK851000819660821861000819940930070776810008199409306910004051870100010801000400038020017201207011435010008710001P08235091000406260920008199806221010001W1030008199806221110010S vd Oyeln1115038Baron Schimmelpenninck van der Oyelaan11200021611600062252EB1170011Voorschoten11800160626010010016001119001606262000100160017210001T85100082011031686100082011031758126091000406260920008199806221010001W1030008199806221110010S vd Oyeln11200021611600062252EB7210001I85100081998062286100081998062458131091000405180920008199010021010001W1030008199512131110014Waldorpsstraat112000330411600062521CG7210001I85100081997121386100081997121458133091000405180920008199010021010001W1030008199010021110017Van Swietenstraat11200022011600062518EH7210001A851000819901002861000819940930</ns1:lo3Pl>"
                    + "</ns1:converteerNaarLo3Antwoord>";

    private static final String SYNC_INPUT_LEES_UIT_BRP_ANTWOORD =
            "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"
                    + "<ns1:leesUitBrpAntwoord xmlns:ns1=\"http://www.bzk.nl/migratiebrp/SYNC/0001\">"
                    + "<ns1:status>Ok</ns1:status>"
                    + "<ns1:lo3Pl>01328011810110010580467945701200094008372250210010Josie "
                    +
                    "Beth0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008196608218230003PKA851000819660821861000819660822021500210006Bertha0240005Baarn03100081942083103200040013033000460300410001V621000819660821821000405188220008199409308230002PK851000819660821861000819940930031640210005Jozef0230007van der0240006Blaren03100081936010103200040599033000460300410001M621000819540304821000405188220008199409308230002PK85100081966082186100081994093004086051000400016310003001821000405188220008199409308230002PK851000819660821861000819940930070776810008199409306910004051870100010801000400038020017201207011435010008710001P08235091000406260920008199806221010001W1030008199806221110010S vd Oyeln1115038Baron Schimmelpenninck van der Oyelaan11200021611600062252EB1170011Voorschoten11800160626010010016001119001606262000100160017210001T85100082011031686100082011031758126091000406260920008199806221010001W1030008199806221110010S vd Oyeln11200021611600062252EB7210001I85100081998062286100081998062458131091000405180920008199010021010001W1030008199512131110014Waldorpsstraat112000330411600062521CG7210001I85100081997121386100081997121458133091000405180920008199010021010001W1030008199010021110017Van Swietenstraat11200022011600062518EH7210001A851000819901002861000819940930</ns1:lo3Pl>"
                    + "</ns1:leesUitBrpAntwoord>";

    private static final String SYNC_INPUT_SNCHRONISEER_NAAR_BRP_VERZOEK =
            "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"
                    + "<ns1:synchroniseerNaarBrpVerzoek xmlns:ns1=\"http://www.bzk.nl/migratiebrp/SYNC/0001\">"
                    + "<ns1:lo3BerichtAsTeletexString>01328011810110010580467945701200094008372250210010Josie "
                    +
                    "Beth0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008196608218230003PKA851000819660821861000819660822021500210006Bertha0240005Baarn03100081942083103200040013033000460300410001V621000819660821821000405188220008199409308230002PK851000819660821861000819940930031640210005Jozef0230007van der0240006Blaren03100081936010103200040599033000460300410001M621000819540304821000405188220008199409308230002PK85100081966082186100081994093004086051000400016310003001821000405188220008199409308230002PK851000819660821861000819940930070776810008199409306910004051870100010801000400038020017201207011435010008710001P08235091000406260920008199806221010001W1030008199806221110010S vd Oyeln1115038Baron Schimmelpenninck van der Oyelaan11200021611600062252EB1170011Voorschoten11800160626010010016001119001606262000100160017210001T85100082011031686100082011031758126091000406260920008199806221010001W1030008199806221110010S vd Oyeln11200021611600062252EB7210001I85100081998062286100081998062458131091000405180920008199010021010001W1030008199512131110014Waldorpsstraat112000330411600062521CG7210001I85100081997121386100081997121458133091000405180920008199010021010001W1030008199010021110017Van Swietenstraat11200022011600062518EH7210001A851000819901002861000819940930</ns1:lo3BerichtAsTeletexString>"
                    + "</ns1:synchroniseerNaarBrpVerzoek>";

    private static final String SYNC_INPUT_SYNCHRONISEER_NAAR_BRP_ANTWOORD =
            "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"
                    + "<ns1:synchroniseerNaarBrpAntwoord xmlns:ns1=\"http://www.bzk.nl/migratiebrp/SYNC/0001\">"
                    + "<ns1:status>Onduidelijk</ns1:status>"
                    + "<ns1:persoonslijsten>"
                    + "<ns1:lo3Pl>01328011810110010580467945701200094008372250210010Josie "
                    +
                    "Beth0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008196608218230003PKA851000819660821861000819660822021500210006Bertha0240005Baarn03100081942083103200040013033000460300410001V621000819660821821000405188220008199409308230002PK851000819660821861000819940930031640210005Jozef0230007van der0240006Blaren03100081936010103200040599033000460300410001M621000819540304821000405188220008199409308230002PK85100081966082186100081994093004086051000400016310003001821000405188220008199409308230002PK851000819660821861000819940930070776810008199409306910004051870100010801000400038020017201207011435010008710001P08235091000406260920008199806221010001W1030008199806221110010S vd Oyeln1115038Baron Schimmelpenninck van der Oyelaan11200021611600062252EB1170011Voorschoten11800160626010010016001119001606262000100160017210001T85100082011031686100082011031758126091000406260920008199806221010001W1030008199806221110010S vd Oyeln11200021611600062252EB7210001I85100081998062286100081998062458131091000405180920008199010021010001W1030008199512131110014Waldorpsstraat112000330411600062521CG7210001I85100081997121386100081997121458133091000405180920008199010021010001W1030008199010021110017Van Swietenstraat11200022011600062518EH7210001A851000819901002861000819940930</ns1:lo3Pl>"
                    +
                    "<ns1:lo3Pl>01221011810110010580467945701200094008372250210005Josie0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008199409288230008NAAMWIJZ851000819940928861000819940929511810110010580467945701200094008372250210010Josie Beth0240005Maarn03100081966082103200040014033000460300410001V6110001V821000405188220008199409308230003PKA851000819660821861000819660823021500210006Bertha0240005Baarn03100081942083103200040013033000460300410001V621000819660821821000405188220008199409308230002PK851000819660821861000819940930031480210004Pete0240005Maarn03100081938111803200040013033000460300410001M621000819660821821000405188220008199409308230002PK8510008196608218610008199409300407605100040003821000405188220008199409308230002PK851000819660821861000819920930070776810008199409306910004051870100010801000400038020017201207011435010008710001P08235091000406260920008199806221010001W1030008199806221110010S vd Oyeln1115038Baron Schimmelpenninck van der Oyelaan11200021611600062252EB1170011Voorschoten11800160626010010016001119001606262000100160017210001T85100082011031686100082011031758133091000405180920008199010021010001W1030008199010021110017Van Swietenstraat11200022011600062518EH7210001A851000819901002861000819940930</ns1:lo3Pl>"
                    + "</ns1:persoonslijsten>"
                    + "</ns1:synchroniseerNaarBrpAntwoord>";

    private static final String LO3_INPUT_WA01 =
            "00000000Wa0152417053985201302190008701082011001021506573130210006Anette0240008Vreehoek0310008197604290320004058003300046030";

    private static final String LO3_INPUT_WA01_ONGELDIG =
            "00000000Wa0152417053985201302190008701082011001021506573130210006Anette0240008Vrehoek0310008197604290320004058003300046030";

    private static final String BRP_INPUT_WIJZING_ANUMMER_SIGNAAL =
            "<?xml version=\"1.0\" encoding=\"UTF-8\"?>"
                    + "<wijzigingANummerSignaal xmlns=\"http://www.bzk.nl/migratiebrp/Migratie/0001\" xmlns:ns2=\"http://www.bprbzk.nl/BRP/0001\">"
                    + "<iscGemeenten>"
                    + "<brpGemeente>0600</brpGemeente>"
                    + "</iscGemeenten>"
                    + "<oudANummer>2150657313</oudANummer>"
                    + "<nieuwANummer>2417053985</nieuwANummer>"
                    + "<datumGeldigheid>20130219</datumGeldigheid>"
                    + "</wijzigingANummerSignaal>";

    private final PrettyPrint subject = new PrettyPrint();

    @Test
    public void testSyncConverteerNaarBrpVerzoek() {
        final String result = subject.prettyPrint(maakBericht("SYNC", SYNC_INPUT_CONVERTEER_NAAR_BRP_VERZOEK));
        Assert.assertNotNull(result);
    }

    @Test
    public void testSyncConverteerNaarLo3Antwoord() {
        final String result = subject.prettyPrint(maakBericht("SYNC", SYNC_INPUT_CONVERTEER_NAAR_LO3_ANTWOORD));
        Assert.assertNotNull(result);
    }

    @Test
    public void testSyncLeesUitBrpAntwoord() {
        final String result = subject.prettyPrint(maakBericht("SYNC", SYNC_INPUT_LEES_UIT_BRP_ANTWOORD));
        Assert.assertNotNull(result);
    }

    @Test
    public void testSyncSynchroniseerNaarBrpVerzoek() {
        final String result = subject.prettyPrint(maakBericht("SYNC", SYNC_INPUT_SNCHRONISEER_NAAR_BRP_VERZOEK));
        Assert.assertNotNull(result);
    }

    @Test
    public void testSyncSynchroniseerNaarBrpAntwoord() {
        final String result = subject.prettyPrint(maakBericht("SYNC", SYNC_INPUT_SYNCHRONISEER_NAAR_BRP_ANTWOORD));
        Assert.assertNotNull(result);
    }

    @Test
    public void testLo3() {
        final String result = subject.prettyPrint(maakBericht("VOISC", LO3_INPUT_WA01));
        Assert.assertNotNull(result);
    }

    @Test
    public void testLg01() throws Exception {
        String lg01 = IOUtils.toString(PrettyPrint.class.getResourceAsStream("/pretty/lg01.txt"), Charset.forName("UTF-8"));
        System.out.println(lg01);
        final String result = subject.prettyPrint(maakBericht("VOISC", lg01));
        System.out.println(result);
        Assert.assertNotNull(result);
    }

    @Test
    public void testLo3ongeldig() {
        final String result = subject.prettyPrint(maakBericht("VOISC", LO3_INPUT_WA01_ONGELDIG));
        Assert.assertNotNull(result);
    }


    @Test
    public void testBrp() {
        final String result = subject.prettyPrint(maakBericht("BRP", BRP_INPUT_WIJZING_ANUMMER_SIGNAAL));
        Assert.assertNotNull(result);
    }

    private Bericht maakBericht(final String kanaal, final String bericht) {
        final Bericht result = new Bericht();
        result.setKanaal(kanaal);
        result.setBericht(bericht);

        return result;
    }
}
